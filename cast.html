<body>
  <google-cast-launcher></google-cast-launcher>
</body>
<script>
window['__onGCastApiAvailable'] = function(isAvailable) {
  if (isAvailable) {
    initializeCastApi();
  }
};
</script>
<script src="//www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
<script>
var applicationId = '0B858117';
initializeCastApi = function() {
  cast.framework.CastContext.getInstance().setOptions({
    receiverApplicationId: applicationId,
    autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
  });
};

var context = cast.framework.CastContext.getInstance();
context.addEventListener(
  cast.framework.CastContextEventType.SESSION_STATE_CHANGED,
  function(event) {
    switch (event.sessionState) {
      case cast.framework.SessionState.SESSION_STARTED:
        console.log('CastSession started');
        break;
      case cast.framework.SessionState.SESSION_RESUMED:
        console.log('CastSession resumed');
        break;
      case cast.framework.SessionState.SESSION_ENDED:
        console.log('CastSession disconnected');
        break;
    }
});

function sendMessage(msg){
  var castSession = cast.framework.CastContext.getInstance().getCurrentSession();
  if(castSession){
    castSession.sendMessage('urn:x-cast:com.example.castdata', {
	type: "message"
      	text: msg
    });
  }
}

</script>

